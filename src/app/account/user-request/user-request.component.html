<header class="main-header inline--centred--spaced">
 <p i18n class="mat-h2">Please ask your question</p>
  <button appModalClose mat-icon-button>
          <mat-icon>close</mat-icon>
  </button>
</header>
<main>
  <form
  class="column--centred"
  [formGroup]="requestForm">
    <div class="form__field">
      <header class="inline--centred--spaced">
        <p class="inline--centred">
          <mat-icon class="mr2">subject</mat-icon>
         <span i18n>Choose your subjects</span>
          <span *ngIf="selectedSubjectsCount && selectedSubjectsCount > 0" class="ml2 mat-caption font--grey">({{selectedSubjectsCount}} selected)</span>
        </p>
        <button (click)="toggle('isSubjectsContainerOpen')" mat-icon-button>
          <mat-icon>
            {{formContainerState['isSubjectsContainerOpen'] ? "expand_less":"expand_more"}}
          </mat-icon>
        </button>
      </header>
      <mat-divider></mat-divider>
      <mat-selection-list *ngIf="formContainerState['isSubjectsContainerOpen']" class="subjects-container" formControlName="subjects" id="subjects">
        <mat-list-option [value]="item.id" *ngFor="let item of subjects$ | async">
          <div mat-line>
            {{item.designation}}
          </div>
        </mat-list-option>
      </mat-selection-list>
  </div>
  <div class="form__field">
    <header class="inline--centred--spaced">
      <p class="inline--centred">
        <mat-icon class="mr2">favorite</mat-icon>
        <span i18n>Attach products from your favorites</span>
      <span *ngIf="selectedProductsCount && selectedProductsCount > 0" class="ml2 mat-caption font--grey">({{selectedProductsCount}} selected)</span>
    </p>
      <button (click)="toggle('isProductListContainerOpen')" mat-icon-button>
        <mat-icon>
          {{formContainerState['isProductListContainerOpen'] ? "expand_less":"expand_more"}}
        </mat-icon>
      </button>
    </header>
    <mat-divider></mat-divider>
    <mat-selection-list   *ngIf="formContainerState['isProductListContainerOpen']" class="products-container" formControlName="related_products" id="related_products">
        <mat-list-option [selected]="item.id === (selectedProduct$ | async).id " *ngFor="let item of (forListProducts$ | async)"  [value]="item?.id">
          <img matListAvatar [src]="item.appearanceVariants  | mergeSizeQs:100 ">
          <div>
            {{item?.designation}}
          </div>
        </mat-list-option>
    </mat-selection-list>

</div>
  <div class="form__field">
    <header class="inline--centred--spaced">
      <p class="inline--centred">
        <mat-icon class="mr2">message</mat-icon>
      <span i18n> your  message</span>
      </p>
      <button (click)="toggle('isTextContainerOpen')" mat-icon-button>
        <mat-icon >
          {{formContainerState['isTextContainerOpen'] ? "expand_less":"expand_more"}}
        </mat-icon>
      </button>
    </header>
    <mat-divider></mat-divider>
    <textarea *ngIf="formContainerState['isTextContainerOpen']" rows=5 placeholder="Tape your message" name="text_content" formControlName="text_content" id="text_content">
      </textarea>
</div>
<button
mat-flat-button
(click)="submit()"

[disabled]="!requestForm.valid"
class="my4 form__submit-button"
color="primary"><span i18n>Send request</span></button>
  </form>
</main>
